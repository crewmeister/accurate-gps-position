<!DOCTYPE html>
<html>
<head>
  <title>Accurate GPS position</title>
  <script src="./index.min.js"></script>
</head>
<body>
<h1>Accurate GPS Position</h1>
<p>
  This example page shows a small script originated by 
  <a href="https://twitter.com/gregsramblings">Greg Wilson</a>, 
  <a href="https://github.com/gwilson/getAccurateCurrentPosition">to find a more accurate GPS position</a>
  by giving a timeout+accuracy (in meters) for finding the best GPS position possible, given those ranges.
  <br/>
  We adapted the script bit, npm-ified and made it be hosted here.
  <a href="https://github.com/crewmeister/accurateGpsPosition/">Find the source code here</a>.
</p>

<h2>Start searching position at...</h2>
<pre id="start"></pre>

<h2>Progress</h2>
<pre id="progress"></pre>

<h2>Result</h2>
<pre id="result"></pre>

<h2>Error?</h2>
<pre id="error" style="color: red;">not yet...</pre>

<script>
  
  var options = {
    maxWait: 10000,
    desiredAccuracy: 70,
  };
  document.getElementById('start').innerHTML = new Date() + '\nCalled with options:\n' + JSON.stringify(options, null, 4);

  function stringifyObj(coords) {
    var obj = {};
    for (var key in coords) {
      obj[key] = coords[key];
    }
    return JSON.stringify(obj, null, 4);
  }
  
  function inProgress(pos) {
    document.getElementById('progress').innerHTML += new Date() + '\n' + stringifyObj(pos.coords) + '\n';
  }

  function onSuccess(pos) {
    document.getElementById('result').innerHTML = new Date() + '\n' + stringifyObj(pos.coords);
  }
  
  function onError(err) {
    document.getElementById('error').innerHTML = stringifyObj(err);
  }
  navigator.geolocation.getAccurateCurrentPosition(onSuccess, onError, inProgress, options);
</script>
</body>
</html>
